<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Cliente.Views.PintorView"
             Title="PintorView"
             xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:vmodel="clr-namespace:Cliente.ViewModels">

    <ContentPage.Background>
        <LinearGradientBrush>
            <GradientStop Color="#87CEEB" Offset="0.0" />
            <GradientStop Color="#ADD8E6" Offset="1.0" />
        </LinearGradientBrush>
    </ContentPage.Background>

    <ContentPage.BindingContext>
        <vmodel:PartidaVM/>
    </ContentPage.BindingContext>

    <Grid Padding="20" RowSpacing="10" ColumnSpacing="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="8*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <VerticalStackLayout Grid.Column="0" Grid.Row="1" Background="#E0F2FE" Padding="10" Spacing="10" VerticalOptions="Center">
            <Label Text="ClasificaciÃ³n" TextColor="Black" FontFamily="Comic Sans MS" FontSize="16"></Label>
            <ListView BackgroundColor="Transparent" Margin="0, 0, 0, 10" ItemsSource="{Binding ListaJugadores}" HeightRequest="200">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <ViewCell>

                            <!--<Frame CornerRadius="15" Padding="5" BackgroundColor="#B0E0E6" Margin="5" HasShadow="True">-->
                                <HorizontalStackLayout Spacing="10">
                                    <Label Text="ðŸ…" FontSize="12"/>
                                    <Label Text="{Binding Nombre}" TextColor="Black" FontAttributes="Bold" FontSize="10"/>
                                    <Label Text="{Binding Puntuacion}" TextColor="#FF6347" FontAttributes="Bold" FontSize="10"/>
                                </HorizontalStackLayout>
                            <!--</Frame>-->
                        </ViewCell>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </VerticalStackLayout>

        <VerticalStackLayout Grid.Column="0" Grid.Row="2" >
        <ListView  BackgroundColor="#E0F2FE" ItemsSource="{Binding MensajesChat}" HeightRequest="150">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <HorizontalStackLayout>
                                <Label Text="{Binding Nombre}" TextColor="{Binding Color}" FontAttributes="Bold"/>
                                <Label Text=": " TextColor="{Binding Color}"/>
                                <Label Text="{Binding Msg}" TextColor="{Binding Color}"/>
                        </HorizontalStackLayout>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <HorizontalStackLayout Spacing="5" IsVisible="{Binding NoSoyPintor}" VerticalOptions="End">
            <Entry Placeholder="Â¿QuÃ© es?"
                   PlaceholderColor="#888"
                   BackgroundColor="White"
                   TextColor="#333"
                   Margin="0, 10"
                   FontFamily="Comic Sans MS"
                   Text="{Binding Palabra}"/>

            <Button Text="Enviar"
                    BackgroundColor="#FF69B4"
                    TextColor="White"
                    Padding="10"
                    HorizontalOptions="FillAndExpand"
                    CornerRadius="20"
                    FontFamily="Comic Sans MS"
                    Command="{Binding EnviarCommand}"
                    MaximumHeightRequest="45"/>
        </HorizontalStackLayout>
        </VerticalStackLayout>
        <Label Grid.Column="1" Grid.Row="0" Text="{Binding PalabraAdivinar}" 
               FontSize="28" TextColor="Black" HorizontalOptions="Center" Margin="0, 0, 0, 10"/>

        <VerticalStackLayout Grid.Column="2" Grid.Row="1" IsVisible="{Binding SoyPintor}">
            <Label Text="{Binding Timer}"
                   FontSize="28" TextColor="Black" HorizontalOptions="Center" Margin="0, 0, 0, 10"/>
            <Button Text="ðŸ—‘"
                    Command="{Binding BorrarPizarra}"
                    WidthRequest="40" 
                    BackgroundColor="Transparent"
                    Padding="5"
                    FontSize="20"
                    BorderWidth="1"
                    BorderColor="Gray"
                    CornerRadius="20"/>
        </VerticalStackLayout>
        

        <mct:DrawingView Grid.Column="1" Grid.Row="1" Grid.RowSpan="2"
                         LineColor="White"
                         LineWidth="4"
                         BackgroundColor="#4CAF50"
                         IsMultiLineModeEnabled="True"
                         Lines="{Binding Pizarra, Mode=OneWay}"
                         DrawingLineCompleted="DrawingView_DrawingLineCompleted"
                         IsEnabled="{Binding SoyPintor}"/>
    </Grid>
</ContentPage>